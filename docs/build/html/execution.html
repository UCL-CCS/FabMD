

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>How to run a LAMMPS Job &mdash; FabMD  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/js/versions.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/msmb.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="FabMD Workflow" href="workflow.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html">
          

          
            
            <img src="_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">LAMMPS Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html#namd-installation">NAMD Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html#gromacs-installation">GROMACS Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html#fabmd-installation">FabMD Installation</a></li>
</ul>
<p class="caption"><span class="caption-text">FabMD Workflow</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="workflow.html">FabMD Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="workflow.html#namd-installation">NAMD Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="workflow.html#gromacs-installation">GROMACS Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="workflow.html#fabmd-installation">FabMD Installation</a></li>
</ul>
<p class="caption"><span class="caption-text">Execution</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">How to run a LAMMPS Job</a></li>
<li class="toctree-l1"><a class="reference internal" href="#how-to-run-a-namd-job">How to run a NAMD Job</a></li>
<li class="toctree-l1"><a class="reference internal" href="#how-to-run-a-gromacs-job">How to run a GROMACS Job</a></li>
<li class="toctree-l1"><a class="reference internal" href="#run-ensemble-examples">Run Ensemble Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#lammps-ensemble-example1">lammps_ensemble_example1</a></li>
<li class="toctree-l2"><a class="reference internal" href="#lammps-ensemble-example2">lammps_ensemble_example2</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#gromacs-ensemble-test">Gromacs ensemble test</a></li>
<li class="toctree-l1"><a class="reference internal" href="#easyvvuq-fabmd-example">EasyVVUQ + FabMD example</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id1">Execution</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">FabMD</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>How to run a LAMMPS Job</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/execution.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <p id="execution">This document briefly details how user/developers can set up a remote machine on FabSim3 for job submission.</p>
<div class="section" id="how-to-run-a-lammps-job">
<h1>How to run a LAMMPS Job<a class="headerlink" href="#how-to-run-a-lammps-job" title="Permalink to this headline">¶</a></h1>
<p>For this example we assume LAMMPS has been installed on the desired host machine and the location (<code class="docutils literal notranslate"><span class="pre">lammps_exec</span></code>) has been specified in the file <code class="docutils literal notranslate"><span class="pre">machines_FabMD_user.yml</span></code>.</p>
<p>All the input files required for a LAMMPS simulation should be contained in a directory in <code class="docutils literal notranslate"><span class="pre">config_files</span></code>.</p>
<p>A minimal example LAMMPS simulation is provided in <code class="docutils literal notranslate"><span class="pre">config_files/lammps_test1</span></code>, to execute this example type:</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">fabsim localhost lammps:lammps_test1</span>
</pre></div>
</div>
</div></blockquote>
<p>Modifications can be added in the command line like:</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">fabsim host lammps:lammps_test1,lammps_input:in.lammps</span>
</pre></div>
</div>
</div></blockquote>
<p>or by specifying default values for these arguments in: <code class="docutils literal notranslate"><span class="pre">machines_FabMD_user.yml</span></code>.</p>
<blockquote>
<div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">default</span><span class="p">:</span>
   <span class="nt">lammps_params</span><span class="p">:</span>
      <span class="nt">lammps_input</span><span class="p">:</span> <span class="s">&quot;in.lammps&quot;</span>
      <span class="nt">sweep_dir_name</span><span class="p">:</span> <span class="s">&quot;SWEEP&quot;</span>
      <span class="l l-Scalar l-Scalar-Plain">...</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="how-to-run-a-namd-job">
<h1>How to run a NAMD Job<a class="headerlink" href="#how-to-run-a-namd-job" title="Permalink to this headline">¶</a></h1>
<p>For this example we assume NAMD has been installed on the desired host machine and the location (<code class="docutils literal notranslate"><span class="pre">namd_exec</span></code>) has been specified in the file <code class="docutils literal notranslate"><span class="pre">machines_FabMD_user.yml</span></code>.</p>
<p>All the input files required for a NAMD simulation should be contained in a directory in <code class="docutils literal notranslate"><span class="pre">config_files</span></code>.</p>
<p>A minimal example NAMD simulation is provided in <code class="docutils literal notranslate"><span class="pre">config_files/namd_test1</span></code>, to execute this example type:</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">fabsim localhost namd:namd_test1</span>
</pre></div>
</div>
</div></blockquote>
<p>Modifications can be added in the command line like:</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">fabsim host namd:namd_test1,namd_input:eq0.conf</span>
</pre></div>
</div>
</div></blockquote>
<p>or by specifying default values for these arguments in: <code class="docutils literal notranslate"><span class="pre">machines_FabMD_user.yml</span></code>.</p>
<blockquote>
<div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">default</span><span class="p">:</span>
   <span class="nt">namd_params</span><span class="p">:</span>
      <span class="nt">namd_input</span><span class="p">:</span> <span class="s">&quot;eq0.conf&quot;</span>
      <span class="nt">sweep_dir_name</span><span class="p">:</span> <span class="s">&quot;SWEEP&quot;</span>
      <span class="l l-Scalar l-Scalar-Plain">...</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="how-to-run-a-gromacs-job">
<h1>How to run a GROMACS Job<a class="headerlink" href="#how-to-run-a-gromacs-job" title="Permalink to this headline">¶</a></h1>
<p>For this example we assume GROMACS has been installed on the desired host machine and the location (<code class="docutils literal notranslate"><span class="pre">gromacs_exec</span></code>) has been specified in the file <code class="docutils literal notranslate"><span class="pre">machines_FabMD_user.yml</span></code>.</p>
<p>All the input files required for a GROMACS simulation should be contained in a directory in <code class="docutils literal notranslate"><span class="pre">config_files</span></code>.</p>
<p>A minimal example GROMACS simulation is provided in <code class="docutils literal notranslate"><span class="pre">config_files/gromacs_test</span></code>, to execute this example type:</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">fabsim localhost gromacs:gromacs_test</span>
</pre></div>
</div>
</div></blockquote>
<p>The <code class="docutils literal notranslate"><span class="pre">gromacs</span></code> command first executes grompp and the input files then an MD run on the resulting files. There are three required files for this command and two optional files. The required files are</p>
<blockquote>
<div><ul class="simple">
<li><p>grompp file (<code class="docutils literal notranslate"><span class="pre">.mdp</span></code>)</p></li>
<li><p>conformation file (<code class="docutils literal notranslate"><span class="pre">.gro</span></code>)</p></li>
<li><p>topology file (<code class="docutils literal notranslate"><span class="pre">.top</span></code>)</p></li>
</ul>
</div></blockquote>
<p>These can be specified in three ways, which take decreasing priority:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>In the command line argument.</p></li>
<li><p>As a default in <code class="docutils literal notranslate"><span class="pre">gromacs_params</span></code> in <code class="docutils literal notranslate"><span class="pre">machines_FabMD_user.yml</span></code>.</p></li>
<li><p>A file found in the specified <code class="docutils literal notranslate"><span class="pre">config_files</span></code> directory with the correct extension</p></li>
</ol>
</div></blockquote>
<p>Files are specified in the command line like this:</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">fabsim localhost gromacs:gromacs_test,grompp=nvt.mdp,conf=npt4b.gro,topol=top.top</span>
</pre></div>
</div>
</div></blockquote>
<p>Defaults can be also set in the gromacs default parameters in <code class="docutils literal notranslate"><span class="pre">machines_FabMD_user.yml</span></code>.</p>
<blockquote>
<div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">default</span><span class="p">:</span>
   <span class="nt">gromacs_params</span><span class="p">:</span>
      <span class="nt">sweep_dir_name</span><span class="p">:</span> <span class="s">&quot;SWEEP&quot;</span>
      <span class="nt">required_files</span><span class="p">:</span>
         <span class="nt">grompp</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">nvt.mdp</span>
         <span class="nt">conf</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">npt4b.gro</span>
         <span class="nt">topol</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">top.top</span>
         <span class="nt">checkpoint</span><span class="p">:</span>
         <span class="nt">index</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">index.ndx</span>
      <span class="l l-Scalar l-Scalar-Plain">...</span>
</pre></div>
</div>
</div></blockquote>
<p>Or finally, if a required file is not specified in the command line or as a default it will search for a file with the correct extension in the config directory. If one and only one is found this file is used. If multiple files with the correct extension are found it is ambiguous and an error is issued.</p>
<p>There are two optional files that, if desired, must be specified on the command line.</p>
<blockquote>
<div><ul class="simple">
<li><p>checkpoint file (.cpt)</p></li>
<li><p>index file (.ndx)</p></li>
</ul>
</div></blockquote>
<p>These could be specifed like this:</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">fabsim localhost gromacs:gromacs_test,grompp=nvt.mdp,conf=npt4b.gro,topol=top.top,checkpoint=npt4b.cpt,index=index.ndx</span>
</pre></div>
</div>
</div></blockquote>
<p>or simply set them inside <code class="docutils literal notranslate"><span class="pre">machines_FabMD_user.yml</span></code>. The grompp command executes with all required and optional files. This produces a <code class="docutils literal notranslate"><span class="pre">mdout.mdp</span></code> file which is run with:</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">gmx mdrun</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="run-ensemble-examples">
<h1>Run Ensemble Examples<a class="headerlink" href="#run-ensemble-examples" title="Permalink to this headline">¶</a></h1>
<div class="section" id="lammps-ensemble-example1">
<h2>lammps_ensemble_example1<a class="headerlink" href="#lammps-ensemble-example1" title="Permalink to this headline">¶</a></h2>
<p>These examples assume that you have been able to run the basic examples described above, and that you have installed and configured LAMMPS on the target machine.</p>
<p>To run type:</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">fabsim localhost lammps_ensemble:lammps_ensemble_example1</span>
</pre></div>
</div>
</div></blockquote>
<p>FabMD looks for a directory called <code class="docutils literal notranslate"><span class="pre">lammps_ensemble_example1</span></code> in <code class="docutils literal notranslate"><span class="pre">config_files</span></code>. It then looks for a sweep directory (by default called <code class="docutils literal notranslate"><span class="pre">SWEEP</span></code>) that contains a number of input files to iterate through. All the files in <code class="docutils literal notranslate"><span class="pre">lammps_ensemble_example1</span></code> directory and one of the sweep directory files will be copied to the host in separate directories (one for each sweep file) and executed in the normal way. This example essentially runs the same input script with different topology (data) files.</p>
</div>
<div class="section" id="lammps-ensemble-example2">
<h2>lammps_ensemble_example2<a class="headerlink" href="#lammps-ensemble-example2" title="Permalink to this headline">¶</a></h2>
<p>This example runs 3 simulations with different input files, which vary the simulation temperature, using the same topology file.</p>
<p>To run type:</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">fabsim localhost lammps_ensemble:lammps_ensemble_example2</span>
</pre></div>
</div>
</div></blockquote>
<ul>
<li><p><strong>NOTE</strong> if your input filename is not the same as the one set in lammps_params entry in machines_FabMD_user.yml file, then you will have to specify this in the command line. For example the following command may be more suitable but will run the exact same simulations:</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">fabsim localhost lammps_ensemble:lammps_ensemble_example2,lammps_input=in.peptide</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</div>
</div>
<div class="section" id="gromacs-ensemble-test">
<h1>Gromacs ensemble test<a class="headerlink" href="#gromacs-ensemble-test" title="Permalink to this headline">¶</a></h1>
<p>Hopefully the structure of the ensemble execusion is becoming familar. To run the minimal gromacs ensemble examples type:</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">fabsim localhost gromacs_ensemble:gromacs_ensemble_test,grompp=npt.mdp</span>
</pre></div>
</div>
</div></blockquote>
<p>The run files and SWEEP directory are contained with in <code class="docutils literal notranslate"><span class="pre">config_files/gromacs_ensemble_test</span></code>. The <code class="docutils literal notranslate"><span class="pre">grompp</span></code> file must be specified on the command line because there are a few options in the directory, if this does not make sense please read the <strong>How to run a GROMACS Job section</strong>.</p>
</div>
<div class="section" id="easyvvuq-fabmd-example">
<h1>EasyVVUQ + FabMD example<a class="headerlink" href="#easyvvuq-fabmd-example" title="Permalink to this headline">¶</a></h1>
<p>This example shows how to create an ensemble of LAMMPS simulations using EasyVVUQ, execute the jobs through FabMD, then analyse them within the <a class="reference external" href="https://easyvvuq.readthedocs.io/en/dev/">EasyVVUQ</a> architecture. All within 3 FabSim commands!!!</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All the easyvvuq campaign infantilization, runs execution, and the results analyse will be done on target machine which can be your localhost or remote HPC machine.</p>
</div>
<p>Its a very simple example of a LAMMPS ensemble. 3 runs are created and given different velocity seeds. The solvation energy is calculated at the end of each simulation and the average and standard deviation are output to screen. The intention for this example is to provide a guide to designing your own workflow that uses these two tools together.</p>
<p>The input files needed for this example are found in <code class="docutils literal notranslate"><span class="pre">plugins/FabMD/config_files/fabmd_easyvvuq_test1</span></code>. This directory contains three files:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">lammps.template</span></code>: is the LAMMPS input script in <code class="docutils literal notranslate"><span class="pre">sampler_inputs</span></code> subfolder, EasyVVUQ will substitute certain variables in this file to create the ensemble.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">data.peptide</span></code>: is the configuration file for a peptide in water for LAMMPS simulation. This remains common to all simulations.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">campaign_params.yml</span></code>: is the configuration file, in <code class="docutils literal notranslate"><span class="pre">sampler_inputs</span></code> subfolder, for EasyVVUQ sampler. If you need different sampler, parameter to be varied, or polynomial order, you can set them in this file.</p></li>
</ul>
<div class="section" id="id1">
<h2>Execution<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>These are the commands you needed to run this example:</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">fabsim &lt;remote machine&gt; lammps_init_campaign:fabmd_easyvvuq_test1</span>
<span class="go">fabsim &lt;remote machine&gt; lammps_run_campaign:fabmd_easyvvuq_test1</span>
<span class="go">fabsim &lt;remote machine&gt; lammps_analyse_campaign:fabmd_easyvvuq_test1</span>
</pre></div>
</div>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">&lt;remote</span> <span class="pre">machine&gt;</span></code> can be your <code class="docutils literal notranslate"><span class="pre">localhost</span></code> or a HPC resources.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="workflow.html" class="btn btn-neutral float-left" title="FabMD Workflow" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, Hamid Arabnejad, Derek Groen, Maxime Vassaux, Werner Muller

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  <script>
    var versions_json_url = ''
</script>

<div class="rst-versions" data-toggle="rst-versions" role="note"
     aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"></span>
        
      <span class="fa fa-caret-down"></span>
    </span>

    <div class="rst-other-versions">
        <dl id="versionselector">
            <dt>Other Versions</dt>
        </dl>

    </div>
</div>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>